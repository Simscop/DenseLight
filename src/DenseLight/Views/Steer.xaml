<UserControl
    x:Class="DenseLight.Views.Steer"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:liftui="https://github.com/pchuan98/Lift.UI"
    xmlns:local="clr-namespace:DenseLight.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:oxy="http://oxyplot.org/wpf"
    xmlns:viewModel="clr-namespace:DenseLight.ViewModels"
    d:DataContext="{d:DesignInstance Type=viewModel:SteerViewModel}"
    d:DesignHeight="550"
    d:DesignWidth="800"
    mc:Ignorable="d">

    <Grid>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <StackPanel Orientation="Vertical">
            <DockPanel>
                <Button
                    Command="{Binding ConnectCommand}"
                    Content="Connect"
                    DockPanel.Dock="Right" />
                <ComboBox
                    FontWeight="Bold"
                    ItemsSource="{Binding Coms}"
                    SelectedItem="{Binding SelectedCom}" />
            </DockPanel>
        </StackPanel>

        <GroupBox
            Grid.Row="1"
            BorderBrush="MediumPurple"
            Header="电动台"
            IsEnabled="{Binding IsConnected}"
            Style="{DynamicResource ResourceKey=GroupBoxTab}">
            <StackPanel>
                <UniformGrid Margin="1" Columns="2">
                    <TextBlock
                        HorizontalAlignment="Left"
                        FontSize="12"
                        FontWeight="Bold"
                        Text="Connect State: " />
                    <TextBox
                        VerticalAlignment="Center"
                        FontSize="12"
                        Text="{Binding ConnectionStatus}" />
                </UniformGrid>
                <UniformGrid Margin="1" Columns="2">
                    <StackPanel Margin="1">
                        <TextBlock
                            HorizontalAlignment="Left"
                            FontSize="12"
                            FontWeight="Bold"
                            Text="Z(nm)" />
                        <TextBox
                            Padding="5,0,0,0"
                            VerticalAlignment="Center"
                            FontSize="12"
                            Text="{Binding Z, Mode=TwoWay}" />
                    </StackPanel>
                    <StackPanel Margin="1">
                        <TextBlock
                            HorizontalAlignment="Left"
                            FontSize="12"
                            FontWeight="Bold"
                            Text="ZStep(nm)" />
                        <TextBox
                            Padding="5,0,0,0"
                            VerticalAlignment="Center"
                            FontSize="12"
                            Text="{Binding ZStep}" />
                    </StackPanel>
                </UniformGrid>

                <UniformGrid Margin="1" Columns="2">
                    <Button
                        Margin="5"
                        HorizontalAlignment="Stretch"
                        Command="{Binding MoveZCommand}"
                        CommandParameter="1"
                        Content="+"
                        FontSize="12"
                        FontWeight="Bold" />
                    <Button
                        Margin="5"
                        HorizontalAlignment="Stretch"
                        Command="{Binding MoveZCommand}"
                        CommandParameter="-1"
                        Content="-"
                        FontSize="12"
                        FontWeight="Bold" />
                </UniformGrid>

                <UniformGrid Margin="1" Columns="2">
                    <StackPanel Margin="1">
                        <TextBlock
                            HorizontalAlignment="Left"
                            FontSize="12"
                            FontWeight="Bold"
                            Text="Z Top(nm)" />
                        <TextBox
                            Padding="5,0,0,0"
                            VerticalAlignment="Center"
                            FontSize="12"
                            Text="{Binding ZTop}" />
                    </StackPanel>
                    <StackPanel Margin="1">
                        <TextBlock
                            HorizontalAlignment="Left"
                            FontSize="12"
                            FontWeight="Bold"
                            Text="Z Buttom(nm)" />
                        <TextBox
                            Padding="5,0,0,0"
                            VerticalAlignment="Center"
                            FontSize="12"
                            Text="{Binding ZBottom}" />
                    </StackPanel>
                </UniformGrid>

                <UniformGrid Margin="1" Columns="2">
                    <Button
                        Margin="5"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center"
                        Command="{Binding ResetCommand}"
                        CommandParameter="Move"
                        Content="复位"
                        FontSize="12"
                        FontWeight="Bold" />
                    <Button
                        Margin="5"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center"
                        Command="{Binding StopCommand}"
                        CommandParameter="Stop"
                        Content="停止"
                        FontSize="12"
                        FontWeight="Bold" />
                </UniformGrid>

                <UniformGrid Margin="1" Columns="4">
                    <Button
                        Margin="5"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center"
                        Command="{Binding FocusCommand}"
                        CommandParameter="Move"
                        Content="自动对焦"
                        FontSize="12"
                        FontWeight="Bold" />
                    <Button
                        Margin="5"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center"
                        Command="{Binding ZStackScanCommand}"
                        Content="Z扫描"
                        FontSize="12"
                        FontWeight="Bold" />
                    <Button
                        Margin="5"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center"
                        Command="{Binding RefreshPositionCommand}"
                        Content="刷新坐标"
                        FontSize="12"
                        FontWeight="Bold" />
                    <Button
                        Margin="5"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center"
                        Command="{Binding CancelScanCommand}"
                        Content="取消扫描"
                        FontSize="12"
                        FontWeight="Bold" />
                </UniformGrid>

                <UniformGrid Margin="1" Columns="2">
                    <ProgressBar
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center"
                        Maximum="100"
                        Minimum="0"
                        Visibility="{Binding IsBusy}"
                        Value="{Binding Progress}" />
                    <Label
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center"
                        Content="{Binding CurrentStep, StringFormat='当前Z: {0:F2}'}" />
                </UniformGrid>

                <UniformGrid Margin="1" Columns="2">
                    <StackPanel Margin="1">
                        <TextBlock
                            HorizontalAlignment="Left"
                            FontSize="12"
                            FontWeight="Bold"
                            Text="Z1 (nm)" />
                        <TextBox
                            Padding="5,0,0,0"
                            VerticalAlignment="Center"
                            FontSize="12"
                            Text="{Binding Z1}" />
                    </StackPanel>
                    <StackPanel Margin="1">
                        <TextBlock
                            HorizontalAlignment="Left"
                            FontSize="12"
                            FontWeight="Bold"
                            Text="Z2 (nm)" />
                        <TextBox
                            Padding="5,0,0,0"
                            VerticalAlignment="Center"
                            FontSize="12"
                            Text="{Binding Z2}" />
                    </StackPanel>
                </UniformGrid>

                <UniformGrid Margin="1" Columns="2">

                    <Button
                        Margin="5"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center"
                        Command="{Binding SetZ1Command}"
                        Content="设置Z1"
                        FontSize="12"
                        FontWeight="Bold" />
                    <Button
                        Margin="5"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center"
                        Command="{Binding SetZ2Command}"
                        Content="设置Z2"
                        FontSize="12"
                        FontWeight="Bold" />
                </UniformGrid>

                <UniformGrid>
                    <oxy:PlotView
                        Height="280"
                        Margin="10"
                        VerticalAlignment="Center"
                        Model="{Binding FocusCurve}" />
                </UniformGrid>
            </StackPanel>
        </GroupBox>
    </Grid>

</UserControl>
